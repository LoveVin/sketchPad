{"version":3,"sources":["main.js"],"names":["stor","JSON","parse","localStorage","getItem","storColor","currentColor","colorHashMap","document","querySelectorAll","forEach","element","index","length","style","backgroundColor","dataset","color","canvas","getElementById","width","documentElement","clientWidth","height","clientHeight","ctx","getContext","fillStyle","fillRect","lineCap","IsPoint","last","isTouchDevice","isPaint","currentWidth","querySelector","value","drawline","x1","y1","x2","y2","strokeStyle","lineWidth","beginPath","moveTo","lineTo","stroke","ontouchstart","e","preventDefault","touches","clientX","clientY","ontouchmove","console","log","onmousedown","onmousemove","onmouseup","currentIndex","colorSelector","onchange","target","push","onclick","nextElementSibling","classList","toggle","previousElementSibling","remove","add","el","siblings","parentNode","children","i","parseInt","line","clearRect","url","toDataURL","a","createElement","body","appendChild","href","download","click","removeChild","window","onbeforeunload","hashString1","stringify","setItem","hashString2"],"mappings":"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","file":"main.1311f516.js","sourceRoot":"..\\src","sourcesContent":["/*本地存储*/\r\nlet stor = JSON.parse(localStorage.getItem('colorHashMap'))\r\nlet storColor = JSON.parse(localStorage.getItem('currentColor'))\r\nlet currentColor\r\nlet colorHashMap\r\nif(stor){\r\n    colorHashMap = stor\r\n}\r\nelse{\r\n    colorHashMap = []\r\n}\r\nif(storColor){\r\n    currentColor = storColor\r\n}\r\nelse{\r\n    currentColor = '#000000'\r\n}\r\n\r\n/*本地读取*/\r\ndocument.querySelectorAll('.paintTools .palette > div').forEach((element, index)=>{\r\n    if(index < colorHashMap.length){\r\n        element.style.backgroundColor = colorHashMap[index]\r\n        element.dataset.color = colorHashMap[index]\r\n    }\r\n})\r\n\r\n/*Canvas相关*/\r\nlet canvas = document.getElementById(\"canvas\");\r\ncanvas.width = document.documentElement.clientWidth;\r\ncanvas.height = document.documentElement.clientHeight;\r\nlet ctx = canvas.getContext(\"2d\");\r\nctx.fillStyle = \"#fff\";\r\nctx.fillRect(0, 0, canvas.width, canvas.height);\r\nctx.lineCap = \"round\"\r\nlet IsPoint = false\r\nlet last;\r\nlet isTouchDevice = 'ontouchstart' in document.documentElement;\r\nlet isPaint = true;\r\nlet currentWidth = 2\r\ndocument.querySelector('#colorSelector').value = currentColor\r\nfunction drawline(x1, y1, x2, y2)\r\n{\r\n    ctx.strokeStyle = currentColor;\r\n    ctx.lineWidth = currentWidth;\r\n    ctx.beginPath();\r\n    ctx.moveTo(x1, y1);\r\n    ctx.lineTo(x2, y2);\r\n    ctx.stroke();\r\n}\r\nif(isTouchDevice)\r\n{\r\n    canvas.ontouchstart = (e) =>{\r\n        e.preventDefault()\r\n        last = [e.touches[0].clientX, e.touches[0].clientY];\r\n    }\r\n    canvas.ontouchmove = (e) =>{\r\n        e.preventDefault()\r\n        drawline(last[0],last[1],e.touches[0].clientX,e.touches[0].clientY);\r\n        last = [e.touches[0].clientX, e.touches[0].clientY];\r\n    }\r\n}\r\nelse\r\n{\r\n    if(canvas.getContext)\r\n    {\r\n        console.log(\"该设备支持canvas画板\")\r\n        canvas.onmousedown = (e) =>{\r\n        IsPoint = true;\r\n        last = [e.clientX, e.clientY];\r\n        };\r\n        canvas.onmousemove = (e) => {\r\n        if(IsPoint === true)\r\n        {\r\n            drawline(last[0],last[1],e.clientX,e.clientY)\r\n            last = [e.clientX, e.clientY];\r\n        }\r\n        };\r\n        canvas.onmouseup = () =>{\r\n        IsPoint = false;\r\n        }\r\n    }\r\n    else\r\n    {\r\n        console.log(\"该设备不支持canvas画板\")\r\n    }\r\n}\r\n\r\n/*页面元素*/\r\nlet currentIndex = (colorHashMap.length+1) || 1;\r\ncolorSelector.onchange = (e)=>{\r\n    let element = document.querySelector(`.palette div:nth-child(${currentIndex})`)\r\n    element.style.backgroundColor = e.target.value\r\n    element.dataset.color = e.target.value\r\n    currentIndex = (currentIndex % 15) + 1\r\n    currentColor = e.target.value\r\n    colorHashMap.push(e.target.value)\r\n}\r\ndocument.querySelectorAll('.paintTools .palette > div').forEach((element,index)=>{\r\n    element.dataset.index = index + 1\r\n    element.onclick = (e)=>{\r\n        if(e.target.style.backgroundColor && isPaint){\r\n            currentColor = e.target.dataset.color\r\n            document.querySelector('#colorSelector').value = currentColor\r\n        }\r\n    }\r\n})\r\ndocument.querySelector('.paintWidth .widthSelector').onclick = function(){\r\n    this.nextElementSibling.classList.toggle('hidden')\r\n}\r\ndocument.querySelector('.icon-erase').onclick = function(){\r\n    this.previousElementSibling.classList.remove('selected')\r\n    this.classList.add('selected')\r\n    currentColor = '#ffffff'\r\n    isPaint = false\r\n}\r\ndocument.querySelector('.icon-pen').onclick = function(){\r\n    this.nextElementSibling.classList.remove('selected')\r\n    this.classList.add('selected')\r\n    isPaint = true\r\n    currentColor = document.querySelector('#colorSelector').value\r\n}\r\ndocument.querySelectorAll('.lineSelector > div').forEach((el)=>{\r\n    el.onclick = function(){\r\n        let siblings = this.parentNode.children\r\n        for(let i = 0; i < siblings.length; i++){\r\n            if(siblings[i] !== this){\r\n                siblings[i].classList.remove('selected')\r\n            }\r\n        }\r\n        this.classList.add('selected')\r\n        currentWidth = parseInt(this.dataset.line)\r\n        document.querySelector('.paintWidth .lineSelector').classList.add('hidden')\r\n    }\r\n})\r\ndocument.querySelector('.finishOrclear .icon-clear').onclick = function(){\r\n   ctx.clearRect(0,0,canvas.width,canvas.height);\r\n}\r\ndocument.querySelector('.finishOrclear .icon-download').onclick = function(){\r\n    var url = canvas.toDataURL('image/png');\r\n    //JavaScript初始化下载方法\r\n    var a = document.createElement('a');\r\n    document.body.appendChild(a);\r\n    a.href = url;\r\n    a.download = 'sketchPad.png';\r\n    //执行下载\r\n    a.click();\r\n    document.body.removeChild(a)\r\n}\r\n\r\n/*离开页面前存储数据*/\r\nwindow.onbeforeunload = ()=>{\r\n    const hashString1 = JSON.stringify(colorHashMap);\r\n    localStorage.setItem('colorHashMap',hashString1);\r\n    if(!isPaint){\r\n        currentColor = document.querySelector('#colorSelector').value\r\n    }\r\n    const hashString2 = JSON.stringify(currentColor);\r\n    localStorage.setItem('currentColor',hashString2)\r\n}"]}